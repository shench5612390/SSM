<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mgskj.dao.TVDDataDayMapper">
    <cache eviction="LRU" flushInterval="100000" size="512"
           readOnly="true"/>
    <resultMap id="BaseResultMap" type="com.mgskj.model.TVDDataDay">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        <id column="Id" property="id" jdbcType="INTEGER"/>
        <result column="EquipId" property="equipid" jdbcType="CHAR"/>
        <result column="AvgSpd1" property="avgspd1" jdbcType="DOUBLE"/>
        <result column="Forward1" property="forward1" jdbcType="INTEGER"/>
        <result column="Reverse1" property="reverse1" jdbcType="INTEGER"/>
        <result column="Occupancy1" property="occupancy1" jdbcType="DOUBLE"/>
        <result column="AvgSpd2" property="avgspd2" jdbcType="DOUBLE"/>
        <result column="Forward2" property="forward2" jdbcType="INTEGER"/>
        <result column="Reverse2" property="reverse2" jdbcType="INTEGER"/>
        <result column="Occupancy2" property="occupancy2" jdbcType="DOUBLE"/>
        <result column="AvgSpd3" property="avgspd3" jdbcType="DOUBLE"/>
        <result column="Forward3" property="forward3" jdbcType="INTEGER"/>
        <result column="Reverse3" property="reverse3" jdbcType="INTEGER"/>
        <result column="Occupancy3" property="occupancy3" jdbcType="DOUBLE"/>
        <result column="AvgSpd4" property="avgspd4" jdbcType="DOUBLE"/>
        <result column="Forward4" property="forward4" jdbcType="INTEGER"/>
        <result column="Reverse4" property="reverse4" jdbcType="INTEGER"/>
        <result column="Occupancy4" property="occupancy4" jdbcType="DOUBLE"/>
        <result column="AvgSpd5" property="avgspd5" jdbcType="DOUBLE"/>
        <result column="Forward5" property="forward5" jdbcType="INTEGER"/>
        <result column="Reverse5" property="reverse5" jdbcType="INTEGER"/>
        <result column="Occupancy5" property="occupancy5" jdbcType="DOUBLE"/>
        <result column="StatisticsCount" property="statisticscount"
                jdbcType="INTEGER"/>
        <result column="GatherDate" property="gatherdate" jdbcType="DATE"/>
        <result column="GatherTime" property="gathertime" jdbcType="TIME"/>
        <result column="CreateDate" property="createdate" jdbcType="DATE"/>
        <result column="CreateTime" property="createtime" jdbcType="TIME"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        Id, EquipId, AvgSpd1, Forward1, Reverse1, Occupancy1, AvgSpd2,
        Forward2, Reverse2,
        Occupancy2, AvgSpd3, Forward3, Reverse3,
        Occupancy3, AvgSpd4, Forward4, Reverse4,
        Occupancy4, AvgSpd5, Forward5,
        Reverse5, Occupancy5, StatisticsCount,
        GatherDate,
        GatherTime,
        CreateDate, CreateTime
    </sql>
    <resultMap id="DayResultMap" type="com.mgskj.model.TVDDataDayResult">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        <result column="EquipId" property="equipid" jdbcType="CHAR"/>
        <result column="GatherDate" property="gatherdate" jdbcType="DATE"/>
        <result column="GatherTime" property="gathertime" jdbcType="TIME"/>
        <result column="EquipName" property="equipname" jdbcType="NVARCHAR"/>
        <result column="Forward" property="forward" jdbcType="INTEGER"/>
    </resultMap>
    <sql id="Day_Column_List">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        a.EquipId,
        a.GatherDate,
        a.GatherTime,
        CASE
        WHEN <![CDATA[a.Forward1 < 0]]>
        THEN
        0
        ELSE
        a.Forward1
        END +
        CASE
        WHEN <![CDATA[a.Forward2 < 0]]>
        THEN
        0
        ELSE
        a.Forward2
        END + CASE
        WHEN <![CDATA[a.Forward3 < 0]]>
        THEN
        0
        ELSE
        a.Forward3
        END + CASE
        WHEN <![CDATA[a.Forward4 < 0]]>
        THEN
        0
        ELSE
        a.Forward4
        END +
        CASE
        WHEN <![CDATA[a.Forward5 < 0]]>
        THEN
        0
        ELSE
        a.Forward5
        END AS Forward,
        (
        CASE
        WHEN b.ObBeginDesc != '' THEN
        d.EquipName +
        b.EquipName + '(' + b.ObBeginDesc + '-' + b.ObEndDesc +
        ')'
        ELSE
        d.EquipName + b.EquipName
        END
        ) AS EquipName
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap"
            parameterType="java.lang.Integer">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select
        <include refid="Base_Column_List"/>
        from T_VD_Data_Day
        where Id = #{id,jdbcType=INTEGER}
    </select>
    <select id="selectDayList" resultMap="DayResultMap">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select
        <include refid="Day_Column_List"/>
        from (
        (
        T_VD_Data_DayW a
        INNER JOIN T_VD_Equip b ON a.EquipId = b.Id
        )
        INNER JOIN T_RegionInfo c ON
        c.Id = b.RegionId
        )
        INNER JOIN T_VD_Equip d
        ON b.ControllerId = d.Id
        where
        d.IsDeleted = 0 AND d.InUse = 1
        <if test="date != null and date != ''">
            AND
            datediff(month,convert(nvarchar(10),a.GatherDate,120),#{date,jdbcType=NCHAR})=0
        </if>
        <if
                test="PrefixLength != null and PrefixLength != '' and regionCode != null and regionCode != ''">
            and
            SUBSTRING(c.RegionCode,1,CAST(#{PrefixLength,jdbcType=CHAR}
            as INT))
            =
            SUBSTRING(#{regionCode,jdbcType=NCHAR},1,CAST(#{PrefixLength,jdbcType=CHAR}
            as INT))
        </if>
        ORDER BY b.ControllerId
    </select>
    <select id="selectMonthList" resultMap="DayResultMap">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select
        <include refid="Day_Column_List"/>
        from (
        (
        T_VD_Data_DayW a
        INNER JOIN T_VD_Equip b ON a.EquipId = b.Id
        )
        INNER JOIN T_RegionInfo c ON
        c.Id = b.RegionId
        )
        INNER JOIN T_VD_Equip d
        ON b.ControllerId = d.Id
        where
        d.IsDeleted = 0 AND d.InUse = 1
        <if test="date != null and date != ''">
            AND
            datediff(year,convert(nvarchar(10),a.GatherDate,120),#{date,jdbcType=NCHAR})=0
        </if>
        <if
                test="PrefixLength != null and PrefixLength != '' and regionCode != null and regionCode != ''">
            and
            SUBSTRING(c.RegionCode,1,CAST(#{PrefixLength,jdbcType=CHAR}
            as INT))
            =
            SUBSTRING(#{regionCode,jdbcType=NCHAR},1,CAST(#{PrefixLength,jdbcType=CHAR}
            as INT))
        </if>
        ORDER BY b.ControllerId
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        delete from T_VD_Data_Day
        where Id = #{id,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.mgskj.model.TVDDataDay">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        insert into T_VD_Data_Day (Id, EquipId, AvgSpd1,
        Forward1, Reverse1,
        Occupancy1,
        AvgSpd2, Forward2, Reverse2,
        Occupancy2, AvgSpd3, Forward3,
        Reverse3, Occupancy3, AvgSpd4,
        Forward4, Reverse4, Occupancy4,
        AvgSpd5,
        Forward5, Reverse5,
        Occupancy5, StatisticsCount, GatherDate,
        GatherTime, CreateDate, CreateTime
        )
        values (#{id,jdbcType=INTEGER},
        #{equipid,jdbcType=CHAR},
        #{avgspd1,jdbcType=DOUBLE},
        #{forward1,jdbcType=INTEGER}, #{reverse1,jdbcType=INTEGER},
        #{occupancy1,jdbcType=DOUBLE},
        #{avgspd2,jdbcType=DOUBLE},
        #{forward2,jdbcType=INTEGER},
        #{reverse2,jdbcType=INTEGER},
        #{occupancy2,jdbcType=DOUBLE}, #{avgspd3,jdbcType=DOUBLE},
        #{forward3,jdbcType=INTEGER},
        #{reverse3,jdbcType=INTEGER},
        #{occupancy3,jdbcType=DOUBLE},
        #{avgspd4,jdbcType=DOUBLE},
        #{forward4,jdbcType=INTEGER}, #{reverse4,jdbcType=INTEGER},
        #{occupancy4,jdbcType=DOUBLE},
        #{avgspd5,jdbcType=DOUBLE},
        #{forward5,jdbcType=INTEGER},
        #{reverse5,jdbcType=INTEGER},
        #{occupancy5,jdbcType=DOUBLE}, #{statisticscount,jdbcType=INTEGER},
        #{gatherdate,jdbcType=DATE},
        #{gathertime,jdbcType=TIME},
        #{createdate,jdbcType=DATE},
        #{createtime,jdbcType=TIME}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.mgskj.model.TVDDataDay">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        insert into T_VD_Data_Day
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                Id,
            </if>
            <if test="equipid != null">
                EquipId,
            </if>
            <if test="avgspd1 != null">
                AvgSpd1,
            </if>
            <if test="forward1 != null">
                Forward1,
            </if>
            <if test="reverse1 != null">
                Reverse1,
            </if>
            <if test="occupancy1 != null">
                Occupancy1,
            </if>
            <if test="avgspd2 != null">
                AvgSpd2,
            </if>
            <if test="forward2 != null">
                Forward2,
            </if>
            <if test="reverse2 != null">
                Reverse2,
            </if>
            <if test="occupancy2 != null">
                Occupancy2,
            </if>
            <if test="avgspd3 != null">
                AvgSpd3,
            </if>
            <if test="forward3 != null">
                Forward3,
            </if>
            <if test="reverse3 != null">
                Reverse3,
            </if>
            <if test="occupancy3 != null">
                Occupancy3,
            </if>
            <if test="avgspd4 != null">
                AvgSpd4,
            </if>
            <if test="forward4 != null">
                Forward4,
            </if>
            <if test="reverse4 != null">
                Reverse4,
            </if>
            <if test="occupancy4 != null">
                Occupancy4,
            </if>
            <if test="avgspd5 != null">
                AvgSpd5,
            </if>
            <if test="forward5 != null">
                Forward5,
            </if>
            <if test="reverse5 != null">
                Reverse5,
            </if>
            <if test="occupancy5 != null">
                Occupancy5,
            </if>
            <if test="statisticscount != null">
                StatisticsCount,
            </if>
            <if test="gatherdate != null">
                GatherDate,
            </if>
            <if test="gathertime != null">
                GatherTime,
            </if>
            <if test="createdate != null">
                CreateDate,
            </if>
            <if test="createtime != null">
                CreateTime,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="equipid != null">
                #{equipid,jdbcType=CHAR},
            </if>
            <if test="avgspd1 != null">
                #{avgspd1,jdbcType=DOUBLE},
            </if>
            <if test="forward1 != null">
                #{forward1,jdbcType=INTEGER},
            </if>
            <if test="reverse1 != null">
                #{reverse1,jdbcType=INTEGER},
            </if>
            <if test="occupancy1 != null">
                #{occupancy1,jdbcType=DOUBLE},
            </if>
            <if test="avgspd2 != null">
                #{avgspd2,jdbcType=DOUBLE},
            </if>
            <if test="forward2 != null">
                #{forward2,jdbcType=INTEGER},
            </if>
            <if test="reverse2 != null">
                #{reverse2,jdbcType=INTEGER},
            </if>
            <if test="occupancy2 != null">
                #{occupancy2,jdbcType=DOUBLE},
            </if>
            <if test="avgspd3 != null">
                #{avgspd3,jdbcType=DOUBLE},
            </if>
            <if test="forward3 != null">
                #{forward3,jdbcType=INTEGER},
            </if>
            <if test="reverse3 != null">
                #{reverse3,jdbcType=INTEGER},
            </if>
            <if test="occupancy3 != null">
                #{occupancy3,jdbcType=DOUBLE},
            </if>
            <if test="avgspd4 != null">
                #{avgspd4,jdbcType=DOUBLE},
            </if>
            <if test="forward4 != null">
                #{forward4,jdbcType=INTEGER},
            </if>
            <if test="reverse4 != null">
                #{reverse4,jdbcType=INTEGER},
            </if>
            <if test="occupancy4 != null">
                #{occupancy4,jdbcType=DOUBLE},
            </if>
            <if test="avgspd5 != null">
                #{avgspd5,jdbcType=DOUBLE},
            </if>
            <if test="forward5 != null">
                #{forward5,jdbcType=INTEGER},
            </if>
            <if test="reverse5 != null">
                #{reverse5,jdbcType=INTEGER},
            </if>
            <if test="occupancy5 != null">
                #{occupancy5,jdbcType=DOUBLE},
            </if>
            <if test="statisticscount != null">
                #{statisticscount,jdbcType=INTEGER},
            </if>
            <if test="gatherdate != null">
                #{gatherdate,jdbcType=DATE},
            </if>
            <if test="gathertime != null">
                #{gathertime,jdbcType=TIME},
            </if>
            <if test="createdate != null">
                #{createdate,jdbcType=DATE},
            </if>
            <if test="createtime != null">
                #{createtime,jdbcType=TIME},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.mgskj.model.TVDDataDay">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        update T_VD_Data_Day
        <set>
            <if test="equipid != null">
                EquipId = #{equipid,jdbcType=CHAR},
            </if>
            <if test="avgspd1 != null">
                AvgSpd1 = #{avgspd1,jdbcType=DOUBLE},
            </if>
            <if test="forward1 != null">
                Forward1 = #{forward1,jdbcType=INTEGER},
            </if>
            <if test="reverse1 != null">
                Reverse1 = #{reverse1,jdbcType=INTEGER},
            </if>
            <if test="occupancy1 != null">
                Occupancy1 = #{occupancy1,jdbcType=DOUBLE},
            </if>
            <if test="avgspd2 != null">
                AvgSpd2 = #{avgspd2,jdbcType=DOUBLE},
            </if>
            <if test="forward2 != null">
                Forward2 = #{forward2,jdbcType=INTEGER},
            </if>
            <if test="reverse2 != null">
                Reverse2 = #{reverse2,jdbcType=INTEGER},
            </if>
            <if test="occupancy2 != null">
                Occupancy2 = #{occupancy2,jdbcType=DOUBLE},
            </if>
            <if test="avgspd3 != null">
                AvgSpd3 = #{avgspd3,jdbcType=DOUBLE},
            </if>
            <if test="forward3 != null">
                Forward3 = #{forward3,jdbcType=INTEGER},
            </if>
            <if test="reverse3 != null">
                Reverse3 = #{reverse3,jdbcType=INTEGER},
            </if>
            <if test="occupancy3 != null">
                Occupancy3 = #{occupancy3,jdbcType=DOUBLE},
            </if>
            <if test="avgspd4 != null">
                AvgSpd4 = #{avgspd4,jdbcType=DOUBLE},
            </if>
            <if test="forward4 != null">
                Forward4 = #{forward4,jdbcType=INTEGER},
            </if>
            <if test="reverse4 != null">
                Reverse4 = #{reverse4,jdbcType=INTEGER},
            </if>
            <if test="occupancy4 != null">
                Occupancy4 = #{occupancy4,jdbcType=DOUBLE},
            </if>
            <if test="avgspd5 != null">
                AvgSpd5 = #{avgspd5,jdbcType=DOUBLE},
            </if>
            <if test="forward5 != null">
                Forward5 = #{forward5,jdbcType=INTEGER},
            </if>
            <if test="reverse5 != null">
                Reverse5 = #{reverse5,jdbcType=INTEGER},
            </if>
            <if test="occupancy5 != null">
                Occupancy5 = #{occupancy5,jdbcType=DOUBLE},
            </if>
            <if test="statisticscount != null">
                StatisticsCount = #{statisticscount,jdbcType=INTEGER},
            </if>
            <if test="gatherdate != null">
                GatherDate = #{gatherdate,jdbcType=DATE},
            </if>
            <if test="gathertime != null">
                GatherTime = #{gathertime,jdbcType=TIME},
            </if>
            <if test="createdate != null">
                CreateDate = #{createdate,jdbcType=DATE},
            </if>
            <if test="createtime != null">
                CreateTime = #{createtime,jdbcType=TIME},
            </if>
        </set>
        where Id = #{id,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.mgskj.model.TVDDataDay">
        <!-- WARNING - @mbggenerated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        update T_VD_Data_Day
        set EquipId = #{equipid,jdbcType=CHAR},
        AvgSpd1 =
        #{avgspd1,jdbcType=DOUBLE},
        Forward1 = #{forward1,jdbcType=INTEGER},
        Reverse1 = #{reverse1,jdbcType=INTEGER},
        Occupancy1 =
        #{occupancy1,jdbcType=DOUBLE},
        AvgSpd2 = #{avgspd2,jdbcType=DOUBLE},
        Forward2 = #{forward2,jdbcType=INTEGER},
        Reverse2 =
        #{reverse2,jdbcType=INTEGER},
        Occupancy2 =
        #{occupancy2,jdbcType=DOUBLE},
        AvgSpd3 = #{avgspd3,jdbcType=DOUBLE},
        Forward3 = #{forward3,jdbcType=INTEGER},
        Reverse3 =
        #{reverse3,jdbcType=INTEGER},
        Occupancy3 =
        #{occupancy3,jdbcType=DOUBLE},
        AvgSpd4 = #{avgspd4,jdbcType=DOUBLE},
        Forward4 = #{forward4,jdbcType=INTEGER},
        Reverse4 =
        #{reverse4,jdbcType=INTEGER},
        Occupancy4 =
        #{occupancy4,jdbcType=DOUBLE},
        AvgSpd5 = #{avgspd5,jdbcType=DOUBLE},
        Forward5 = #{forward5,jdbcType=INTEGER},
        Reverse5 =
        #{reverse5,jdbcType=INTEGER},
        Occupancy5 =
        #{occupancy5,jdbcType=DOUBLE},
        StatisticsCount =
        #{statisticscount,jdbcType=INTEGER},
        GatherDate =
        #{gatherdate,jdbcType=DATE},
        GatherTime = #{gathertime,jdbcType=TIME},
        CreateDate = #{createdate,jdbcType=DATE},
        CreateTime =
        #{createtime,jdbcType=TIME}
        where Id = #{id,jdbcType=INTEGER}
    </update>
</mapper>